@page
@model MilkBabyRazorWebApp.Pages.ReviewPage.IndexModel

<h1>Review List</h1>

<div class="table-container">
    <div>
        <form method="get">
            <input type="text" id="searchInput" name="SearchTerm" value="@Model.SearchTerm" placeholder="Search...">
            <button type="button" class="btn btn-primary" onclick="searchFunction()">Search</button>
            <a asp-page="./Index" class="btn btn-info">Reset</a>
        </form>
    </div>

    <div style="margin-top: 10px;">
        <a asp-page="Create" class="btn btn-primary">Create New</a>
    </div>

    <table class="table table-striped table-bordered">
        <thead class="thead-dark">
            <tr>
                <th>Customer Name</th>
                <th>Product Name</th>
                <th>Review Title</th>
                <th>Review Text</th>
                <th>Review Image</th>
                <th>Rating</th>
                <th>Helpful Count</th>
                <th>Not Helpful Count</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody>
            @foreach (var item in Model.Review)
            {
                <tr>
                    <td>@item.Customer.CustomerName</td>
                    <td>@item.Product.ProductName</td>
                    <td>@item.ReviewTitle</td>
                    <td>@item.ReviewText</td>
                    <td>@item.ReviewImg</td>
                    <td>@item.Rating</td>
                    <td>@item.ReviewHelpfulCount</td>
                    <td>@item.ReviewNotHelpfulCount</td>
                    <td>
                        <div class="btn-group" role="group">
                            <a asp-page="./Edit" asp-route-id="@item.ReviewId" class="btn btn-primary">Edit</a>
                            <a asp-page="./Details" asp-route-id="@item.ReviewId" class="btn btn-info">Details</a>
                            <a asp-page="./Delete" asp-route-id="@item.ReviewId" class="btn btn-danger">Delete</a>
                        </div>
                    </td>
                </tr>
            }
        </tbody>
    </table>
</div>

<script>
    function searchFunction() {
        var input, filter, table, tr, td, i, j, txtValue;
        var columnsToSearch = [0, 1, 2, 3, 4, 5, 6, 7]; // Chỉ số cột cần tìm kiếm: 0 - Customer Name, 1 - Product Name, 2 - Review Title, 3 - Review Text, 4 - Review Image, 5 - Rating, 6 - Helpful Count, 7 - Not Helpful Count
        input = document.getElementById("searchInput");
        filter = input.value.toUpperCase();
        table = document.querySelector(".table");
        tr = table.getElementsByTagName("tr");

        for (i = 0; i < tr.length; i++) {
            var found = false;
            for (j = 0; j < columnsToSearch.length; j++) {
                td = tr[i].getElementsByTagName("td")[columnsToSearch[j]];
                if (td) {
                    txtValue = td.textContent || td.innerText;
                    if (txtValue.toUpperCase().indexOf(filter) > -1) {
                        found = true;
                        break;
                    }
                }
            }
            if (found) {
                tr[i].style.display = "";
            } else {
                tr[i].style.display = "none";
            }
        }
    }
</script>
